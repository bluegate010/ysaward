/*! jQuery-hijax v1.0.0 License: https://github.com/smartystreets/jquery-hijax/ */
(function(e,t){"use strict";function r(t){e(document).on(t.trigger||"click submit",this.selector,function(n){var r=e(this);var s={};var o=(t.trigger||(r.is("form")?"submit":"click")).split();for(var u in o)s[o[u]]=true;if(s[n.type])i.call(r,t,n)})}function i(e,t){t.preventDefault?t.preventDefault():t.returnValue=false;var n=e.before.call(this,t);if(n===false)return;n=n||{};var r=o.call(this,e,n);if(r&&r.url&&r.lock()&&a(r,e,n)===false)r.unlock()}function s(){}function o(t,n){var r=this.attr(this.is("form")?"action":"href")||t.url;var i=this;var s=this[0];var o=e.extend({id:function(e,t){for(t=e="";e++<36;t+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return t}(),context:i,url:r,data:"",method:this.attr("method")||t.method,headers:{},async:t.async,timeout:t.timeout,cache:t.cache,dataType:t.dataType,contentType:t.contentType,lock:function(){if(t.concurrent)return true;if(!s.hijaxId||s.hijaxId===this.id)return s.hijaxId=this.id},unlock:function(){if(this.id===s.hijaxId)s.hijaxId=undefined}},t.request.call(this,r,n,t)||{});if(typeof o.data==="object")o.data=JSON.stringify(o.data);else if(!o.data&&this.is("form")){o.contentType="application/x-www-form-urlencoded";o.data=this.serialize()}u(t.headers,o.headers);o.headers["x-hijax-id"]=o.id;return o}function u(e,t){for(var n in e)if(t[n]===undefined)t[n]=e[n]}function a(t,n,r){t.attempt=(t.attempt||0)+1;if(t.attempt>n.attempts)return false;if(n.progress.call(t.context,t.attempt,r)===false)return n.complete.call(t.context,undefined,r);return e.ajax({url:t.url,type:t.method,data:t.data,async:t.async,timeout:t.timeout,cache:t.cache,context:t.context,dataType:t.dataType,contentType:t.contentType,headers:t.headers,success:function(e){t.result=e},complete:function(e,i){f.call({request:t,xhr:e,timeout:i==="timeout",config:n,state:r})}})||true}function f(){try{if(c.call(this)===true)p.call(this)}catch(e){p.call(this,e)}}function l(e,n){t.location=n}function c(){var e=this.request.context;var t=this.xhr;var n=this.config;var r=this.state;var i=t.getResponseHeader("Location");if(i)n.redirect.call(e,t,i,r);else if(t.status>=200&&t.status<=206||t.status==304)n.success.call(e,t,this.request.result,r);else if(t.status===400)n.validation.call(e,t,h(t.responseText),r);else if(t.status===401)n.authentication.call(e,t,r);else if(t.status===403)n.authorization.call(e,t,r);else if(t.status===500||this.timeout){var s=a(this.request,n,r);if(s===false)n.failure.call(e,t,r);return!s}else if(t.status>=400||this.timeout)n.failure.call(e,t,r);return true}function h(t){try{return e.parseJSON(t)}catch(n){return t}}function p(e){this.request.unlock();if(e)this.config.exception.call(this.request.context,this.xhr,e,this.state);this.config.complete.call(this.request.context,this.xhr,this.state)}var n={};e.hijaxSetup=function(t){n=e.extend({async:true,method:"GET",cache:false,timeout:12e3,contentType:"application/json",dataType:"text json",headers:{},attempts:1,concurrent:false,before:s,request:s,progress:s,success:s,failure:s,complete:s,validation:s,authentication:s,authorization:s,redirect:l,exception:s},t);return this};e.hijax=function(t){t=e.extend({trigger:"now",concurrent:true},t);e(document).hijax(t)};e.fn.hijax=function(t){e.hijaxSetup(n);t=e.extend({},n,t);u(n.headers,t.headers);if(this.selector)return r.call(this,t)||this;return this.each(function(){var n=e(this);var r=t.trigger||(n.is("form")?"submit":"click");if(r.toString().toLowerCase()==="now")return i.call(n,t,{});n.on(r,function(e){i.call(n,t,e)})})}})(jQuery,window)